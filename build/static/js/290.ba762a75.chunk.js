"use strict";(self.webpackChunkdrcbd_frontend=self.webpackChunkdrcbd_frontend||[]).push([[290],{8290:(t,e,o)=>{o.r(e),o.d(e,{default:()=>c});var d=o(390),n=o(9134),i=o(2559);const r=t=>{let{totalPrice:e,cartId:o}=t;const r=localStorage.getItem("delver_address"),a=window.OmiseCard;(0,d.useEffect)((()=>{const t=document.createElement("script");return t.src="https://cdn.omise.co/omise.js",t.async=!0,t.onload=l,document.body.appendChild(t),()=>{document.body.removeChild(t)}}),[]);const l=()=>{if(window.OmiseCard){document.getElementById("checkout-button")&&a.configureButton("#checkout-button",{currency:"thb",frameLabel:"Sabai Shop",submitLabel:"PAY NOW",buttonLabel:"Pay with Omise"})}},c=t=>{t.preventDefault(),a.configure({defaultPaymentMethod:"credit_card",otherPaymentMethod:[]}),a.configureButton("#credit-card"),a.attach(),(async()=>{const t=localStorage.getItem("token"),d=await n.Z.get("https://drcbd-backend-zgqu.onrender.com/orders/total_orders");t&&a.open({frameLabel:"DRCBD Store",frameDescription:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0")),amount:100*Number(e),publicKey:"pkey_test_5yyqilk4aaws7x9ldno",onCreateTokenSuccess:async i=>{const a=i,l=await n.Z.post("https://drcbd-backend-zgqu.onrender.com/orders/pay_withe_omise",{token:a,amount:100*Number(e),cartId:o,userAdd:JSON.parse(r),description:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0"))},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});l.data.authorizeUri&&(localStorage.setItem("omisePaymentId",l.data.paymentId),window.location.href=l.data.authorizeUri)},onFormClosed:()=>{}})})()};return(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{id:"checkout-button",style:{display:"none"}}),(0,i.jsx)("form",{children:(0,i.jsx)("button",{onClick:t=>c(t),id:"credit-card",children:"Pay With Credit/Debit Card"})})]})},a=t=>{let{totalPrice:e,cartId:o}=t;const r=window.OmiseCard,a=localStorage.getItem("delver_address");(0,d.useEffect)((()=>{const t=document.createElement("script");return t.src="https://cdn.omise.co/omise.js",t.async=!0,t.onload=l,document.body.appendChild(t),()=>{document.body.removeChild(t)}}),[]);const l=()=>{window.OmiseCard&&r.configureButton("#internet_banking",{currency:"thb",frameLabel:"Sabai Shop",submitLabel:"PAY NOW",buttonLabel:"Pay with Omise"})},c=t=>{t.preventDefault(),r.configure({defaultPaymentMethod:"internet_banking",otherPaymentMethod:["bill_payment_tesco_lotus","alipay","credit_card","pay_easy","net_banking","convenience_store"]}),r.configureButton("#internet_banking"),r.attach(),(async()=>{const t=localStorage.getItem("token");if(t){const d=await n.Z.get("https://drcbd-backend-zgqu.onrender.com/orders/total_orders");console.log(d.data.totalOrder+1),r.open({frameLabel:"DRCBD Store",frameDescription:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0")),amount:100*Number(e),publicKey:"pkey_test_5yyqilk4aaws7x9ldno",onCreateTokenSuccess:async d=>{const i=d;console.log(i);const r=await n.Z.post("https://drcbd-backend-zgqu.onrender.com/orders/pay_withe_omise_bank",{token:i,amount:100*Number(e),cartId:o,userAdd:JSON.parse(a)},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});r.data.authorizeUri&&(localStorage.setItem("omisePaymentId",r.data.paymentId),window.location.href=r.data.authorizeUri)},onFormClosed:()=>{console.log("close")}})}})()};return(0,i.jsxs)("div",{children:[" ",(0,i.jsx)("script",{url:"https://cdn.omise.co/omise.js",onLoad:l}),(0,i.jsx)("form",{children:(0,i.jsx)("button",{onClick:t=>c(t),id:"internet_banking",children:"Pay With internet banking"})})," "]})};var l=o(1750);const c=()=>{var t,e,o,n,c,s,u,p;const[h,m]=(0,d.useState)({}),y=["Product","Quantity","Price","Delivery Charge"],[v,b]=(0,d.useState)(0),x=(0,l.v9)((t=>t.cart));return(0,d.useEffect)((()=>{(async()=>{var t;const e=[];let o=0;null===x||void 0===x||null===(t=x.cart)||void 0===t||t.items.forEach((t=>{var d,n;e.push({deliveryCharge:(null===x||void 0===x||null===(d=x.cart)||void 0===d?void 0:d.totalPrice)<1500?50:0,quantity:t.quantity,productId:t.productId}),o=(null===x||void 0===x||null===(n=x.cart)||void 0===n?void 0:n.totalPrice)<1500?50:0})),m(e),b(o)})()}),[null===x||void 0===x||null===(t=x.cart)||void 0===t?void 0:t.items,null===x||void 0===x||null===(e=x.cart)||void 0===e?void 0:e.totalPrice]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:"5rem",height:"100%",paddingBottom:"2rem"},children:[(0,i.jsx)("h1",{className:"title-text",style:{paddingBottom:"1rem"},children:"Complete you order"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",maxWidth:"800px",width:"100%",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{maxWidth:"600px",width:"100%",padding:"1rem"},className:"center",children:[(0,i.jsx)("h3",{children:"Order Summery"}),(0,i.jsx)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",border:"1px solid #003735",padding:"5px",background:"#003735",color:"#fff"},children:null===y||void 0===y?void 0:y.map((t=>(0,i.jsx)("p",{style:{width:"Product"===t?"55%":"15%",textAlign:"Product"===t?"start":"center",borderLeft:"Product"===t?"0":"1px solid",fontWeight:"bold"},children:t},t)))}),(0,i.jsxs)("div",{style:{width:"100%",borderLeft:"1px solid",borderRight:"1px solid",borderBottom:"1px solid"},children:[(null===h||void 0===h?void 0:h.length)>0&&(null===h||void 0===h?void 0:h.map(((t,e)=>(0,i.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid",padding:"5px",fontWeight:"bold",height:"4rem"},children:[(0,i.jsx)("p",{style:{width:"55%"},children:t.productId.name}),(0,i.jsx)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:null===t||void 0===t?void 0:t.quantity}),(0,i.jsxs)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",null===t||void 0===t?void 0:t.productId.price]}),(0,i.jsxs)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",null===t||void 0===t?void 0:t.deliveryCharge]})]},e)))),(0,i.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",padding:"5px",fontWeight:"bold"},children:[(0,i.jsx)("p",{style:{width:"52.5%"},children:"Total"}),(0,i.jsx)("p",{style:{width:"10%",textAlign:"center",borderLeft:"1px solid",paddingLeft:"20px"},children:null===x||void 0===x||null===(o=x.cart)||void 0===o?void 0:o.totalItems}),(0,i.jsx)("p",{}),(0,i.jsxs)("p",{style:{width:"30%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",(null===x||void 0===x||null===(n=x.cart)||void 0===n?void 0:n.totalPrice)+v]})]})]})]})}),(0,i.jsx)(r,{totalPrice:(null===x||void 0===x||null===(c=x.cart)||void 0===c?void 0:c.totalPrice)+v,cartId:null===x||void 0===x||null===(s=x.cart)||void 0===s?void 0:s._id}),(0,i.jsx)("div",{style:{height:"20px"}}),(0,i.jsx)(a,{totalPrice:(null===x||void 0===x||null===(u=x.cart)||void 0===u?void 0:u.totalPrice)+v,cartId:null===x||void 0===x||null===(p=x.cart)||void 0===p?void 0:p._id})]})})}}}]);
//# sourceMappingURL=290.ba762a75.chunk.js.map