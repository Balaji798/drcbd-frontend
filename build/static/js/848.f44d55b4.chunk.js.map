{"version":3,"file":"static/js/848.f44d55b4.chunk.js","mappings":"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","sources":["pages/sign-in/SignIn.jsx"],"sourcesContent":["import { Link } from \"react-router-dom\";\r\nimport React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./register.css\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { authSuccessful, updateUser } from \"../../state/actions/authAction\";\r\n\r\nconst SignIn = () => {\r\n  //const {data:session} = useSession();\r\n  const dispatch = useDispatch();\r\n  const [open, setOpen] = useState();\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [token, setToken] = useState(false);\r\n  const [verify, setVerify] = useState(false);\r\n  const [password, setPassword] = useState(false);\r\n  const [fides, setFides] = useState(false);\r\n  const [email, setEmail] = useState(false);\r\n  const [otpValidation,setOtpValidation]=useState(false)\r\n  const [user, setUser] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n  const navigate = useNavigate();\r\n\r\n  // if(session){\r\n  //    return <div>Welcome {session.user.email}</div>\r\n  // }else{\r\n\r\n  // }]\r\n  const verifyEmail = async () => {\r\n    if(otp=== \"\"){\r\n      setOtpValidation(true)\r\n      return\r\n    }\r\n    const res = await axios.post(\r\n      \"https://drcbd-backend-zgqu.onrender.com/user/email_verification\",\r\n      //https://52.77.244.89:8080\r\n      { otp: otp }\r\n    );\r\n    if (!res.data.status) {\r\n      setToken(true);\r\n    }\r\n    if (res.data.status === true) {\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      await updateUser(dispatch);\r\n      navigate(\"/\");\r\n    }\r\n  };\r\n  const sendOtp = async () => {\r\n    try {\r\n      const { data } = await axios.post(\r\n        \"https://drcbd-backend-zgqu.onrender.com/user/send_otp\",\r\n        user\r\n      );\r\n      if (data.status) setVerify(true);\r\n    } catch (err) {\r\n      alert(err);\r\n    }\r\n  };\r\n\r\n  const handelLogin = async () => {\r\n    const userToken = localStorage.getItem(\"token\");\r\n    if (\r\n      user.email === \"\" ||\r\n      user.password === \"\"\r\n    ) {\r\n      setFides(true);\r\n      return;\r\n    }\r\n    if (\r\n      !user?.email\r\n        ?.toLowerCase()\r\n        .match(\r\n          /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|.(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n        )\r\n    ) {\r\n      setEmail(true);\r\n      return;\r\n    }\r\n    const response = await axios.post(\r\n      \"https://drcbd-backend-zgqu.onrender.com/user/login\",\r\n      user\r\n    );\r\n    //https://52.77.244.89:8080\r\n    if (response?.data?.email) {\r\n      if (userToken) {\r\n        localStorage.removeItem(\"token\");\r\n      }\r\n      setEmail(true);\r\n      return;\r\n    } else if (response?.data?.password) {\r\n      if (userToken) {\r\n        localStorage.removeItem(\"token\");\r\n      }\r\n      setPassword(true);\r\n      return;\r\n    }\r\n    await authSuccessful(dispatch, response.data.user);\r\n    if (!response?.data?.user?.emailVerified) {\r\n      setOpen(true);\r\n    } else {\r\n      if (user) {\r\n        localStorage.removeItem(\"token\");\r\n      }\r\n      localStorage.setItem(\"token\", response.data.token);\r\n      await updateUser(dispatch);\r\n      navigate(\"/\");\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        color: \"#005652\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        padding: \"5em 0\",\r\n      }}\r\n    >\r\n      {open ? (\r\n        verify ? (\r\n          <div className=\"register-container\">\r\n            <h3 style={{ textTransform: \"capitalize\" }}>\r\n              {\" \"}\r\n              We have send an otp to your email please use that otp to verify\r\n              your email\r\n            </h3>\r\n            <p\r\n              style={{\r\n                textAlign: \"center\",\r\n                fontSize: \"16px\",\r\n                padding: \"0.7em 0\",\r\n                fontWeight: \"bold\",\r\n              }}\r\n            >\r\n              OTP(One Time Password)\r\n            </p>\r\n            <input\r\n              style={{\r\n                width: \"50%\",\r\n                padding: \"5px\",\r\n                fontSize: 15,\r\n                borderRadius: 10,\r\n                border: \"1px solid grey\",\r\n              }}\r\n              onChange={(e) => {\r\n                setOtp(e.target.value);\r\n                setOtpValidation(false)\r\n              }}\r\n            />\r\n            {otpValidation && (\r\n              <p style={{ color: \"red\" }}>OTP required</p>\r\n            )}\r\n            {token && (\r\n              <p style={{ color: \"red\", paddingTop: 10 }}>Not a valid OTP</p>\r\n            )}\r\n            <button\r\n              style={{ marginTop: \"1rem\", maxWidth: 200 }}\r\n              onClick={verifyEmail}\r\n            >\r\n              Verify Email\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"register-container\">\r\n            <p>Your email is not verified please Verify your email first</p>\r\n            <button onClick={sendOtp}>Verify</button>\r\n          </div>\r\n        )\r\n      ) : (\r\n        <div className=\"register-container\">\r\n          <h1>\r\n            Sign in |{\" \"}\r\n            <Link to=\"/register\" style={{ color: \"#99a79f\" }}>\r\n              Register\r\n            </Link>\r\n          </h1>\r\n          <p> Email Address *</p>\r\n          <input\r\n            type=\"email\"\r\n            value={user.email}\r\n            required\r\n            onChange={(e) => {\r\n              setEmail(false);\r\n              setUser({ ...user, email: e.target.value });\r\n              setFides(false)\r\n            }}\r\n          />\r\n          {fides && user.email === \"\" && (\r\n            <p style={{ color: \"red\" }}>Email required</p>\r\n          )}\r\n          {email && (\r\n            <p style={{ color: \"red\" }}>\r\n              Email is not valid or you are not Signup\r\n            </p>\r\n          )}\r\n          <p>Password</p>\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            onChange={(e) => {\r\n              setPassword(false);\r\n              setUser({ ...user, password: e.target.value });\r\n              setFides(false)\r\n            }}\r\n          />\r\n          {fides && user.password === \"\" && (\r\n            <p style={{ color: \"red\" }}>Password required</p>\r\n          )}\r\n          {password && <p style={{ color: \"red\" }}>Password is not valid</p>}\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              justifyContent: \"space-between\",\r\n              alignItems: \"center\",\r\n              flexWrap: \"wrap\",\r\n            }}\r\n          >\r\n            <Link to=\"/forgot-password\" style={{ fontSize: 20 }}>\r\n              Forgot your password\r\n            </Link>\r\n          </div>\r\n          <button\r\n            style={{\r\n              marginTop: \"1em\",\r\n              fontSize: \"30px\",\r\n              textAlign: \"center\",\r\n              width: \"35%\",\r\n              padding: \"10px\",\r\n              border: \"none\",\r\n              background: \"#0b4640\",\r\n              color: \"#fff\",\r\n              fontWeight: \"bold\",\r\n              cursor: \"pointer\",\r\n            }}\r\n            onClick={handelLogin}\r\n          >\r\n            Log in\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SignIn;\r\n"],"names":["SignIn","dispatch","useDispatch","open","setOpen","useState","otp","setOtp","token","setToken","verify","setVerify","password","setPassword","fides","setFides","email","setEmail","otpValidation","setOtpValidation","user","setUser","navigate","useNavigate","_jsx","style","color","display","flexDirection","justifyContent","alignItems","padding","children","_jsxs","className","textTransform","textAlign","fontSize","fontWeight","width","borderRadius","border","onChange","e","target","value","paddingTop","marginTop","maxWidth","onClick","async","res","axios","post","data","status","localStorage","setItem","updateUser","err","alert","Link","to","type","required","flexWrap","background","cursor","_user$email","_response$data","_response$data2","_response$data3","_response$data3$user","userToken","getItem","toLowerCase","match","response","removeItem","authSuccessful","emailVerified","window","location","reload"],"sourceRoot":""}