"use strict";(self.webpackChunkdrcbd_frontend=self.webpackChunkdrcbd_frontend||[]).push([[290],{8290:(t,e,o)=>{o.r(e),o.d(e,{default:()=>s});var d=o(390),n=o(9134),r=o(2559);const i=t=>{let{totalPrice:e,cartId:o}=t;const i=localStorage.getItem("delver_address"),a=window.OmiseCard;(0,d.useEffect)((()=>{const t=document.createElement("script");return t.src="https://cdn.omise.co/omise.js",t.async=!0,t.onload=l,document.body.appendChild(t),()=>{document.body.removeChild(t)}}),[]);const l=()=>{if(window.OmiseCard){document.getElementById("checkout-button")&&a.configureButton("#checkout-button",{currency:"thb",frameLabel:"Sabai Shop",submitLabel:"PAY NOW",buttonLabel:"Pay with Omise"})}},c=t=>{t.preventDefault(),a.configure({defaultPaymentMethod:"credit_card",otherPaymentMethod:[]}),a.configureButton("#credit-card"),a.attach(),(async()=>{const t=localStorage.getItem("token"),d=await n.Z.get("https://drcbd-backend-test.onrender.com/orders/total_orders");t&&a.open({frameLabel:"DRCBD Store",frameDescription:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0")),amount:100*Number(e),publicKey:"pkey_5whyumj8qwo472mjrsh",onCreateTokenSuccess:async r=>{const a=r,l=await n.Z.post("https://drcbd-backend-test.onrender.com/orders/pay_withe_omise",{token:a,amount:100*Number(e),cartId:o,userAdd:JSON.parse(i),description:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0"))},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});l.data.authorizeUri&&(localStorage.setItem("omisePaymentId",l.data.paymentId),window.location.href=l.data.authorizeUri)},onFormClosed:()=>{}})})()};return(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{id:"checkout-button",style:{display:"none"}}),(0,r.jsx)("form",{children:(0,r.jsx)("button",{onClick:t=>c(t),id:"credit-card",children:"Pay With Credit/Debit Card"})})]})},a=t=>{let{totalPrice:e,cartId:o}=t;const i=window.OmiseCard,a=localStorage.getItem("delver_address");(0,d.useEffect)((()=>{const t=document.createElement("script");return t.src="https://cdn.omise.co/omise.js",t.async=!0,t.onload=l,document.body.appendChild(t),()=>{document.body.removeChild(t)}}),[]);const l=()=>{window.OmiseCard&&i.configureButton("#internet_banking",{currency:"thb",frameLabel:"DR.CBD Store",submitLabel:"PAY NOW",buttonLabel:"Pay with Omise"})},c=t=>{t.preventDefault(),i.configure({defaultPaymentMethod:"internet_banking",otherPaymentMethod:["bill_payment_tesco_lotus","alipay","credit_card","pay_easy","net_banking","convenience_store"]}),i.configureButton("#internet_banking"),i.attach(),(async()=>{const t=localStorage.getItem("token");if(t){const d=await n.Z.get("https://drcbd-backend-test.onrender.com/orders/total_orders");i.open({frameLabel:"DRCBD Store",frameDescription:"Invoice #".concat(String(d.data.totalOrder+1).padStart(5,"0")),amount:100*Number(e),publicKey:"pkey_5whyumj8qwo472mjrsh",onCreateTokenSuccess:async d=>{const r=d,i=await n.Z.post("https://drcbd-backend-test.onrender.com/orders/pay_withe_omise_bank",{token:r,amount:100*Number(e),cartId:o,userAdd:JSON.parse(a)},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});i.data.authorizeUri&&(localStorage.setItem("omisePaymentId",i.data.paymentId),window.location.href=i.data.authorizeUri)},onFormClosed:()=>{console.log("close")}})}})()};return(0,r.jsxs)("div",{children:[" ",(0,r.jsx)("script",{url:"https://cdn.omise.co/omise.js",onLoad:l}),(0,r.jsx)("form",{children:(0,r.jsx)("button",{onClick:t=>c(t),id:"internet_banking",children:"Pay With internet banking"})})," "]})};var l=o(1750),c=o(2540);const s=()=>{var t,e,o,n,s,u,h,p;const{language:m}=(0,c.Z)(),[y,v]=(0,d.useState)({}),b=["Product","Quantity","Price","Delivery Charge"],[x,g]=(0,d.useState)(0),f=(0,l.v9)((t=>t.cart));return(0,d.useEffect)((()=>{(async()=>{var t;const e=[];let o=0;null===f||void 0===f||null===(t=f.cart)||void 0===t||t.items.forEach((t=>{var d,n;e.push({deliveryCharge:(null===f||void 0===f||null===(d=f.cart)||void 0===d?void 0:d.totalPrice)<1500?50:0,quantity:t.quantity,productId:t.productId}),o=(null===f||void 0===f||null===(n=f.cart)||void 0===n?void 0:n.totalPrice)<1500?50:0})),v(e),g(o)})()}),[null===f||void 0===f||null===(t=f.cart)||void 0===t?void 0:t.items,null===f||void 0===f||null===(e=f.cart)||void 0===e?void 0:e.totalPrice]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:"5rem",height:"100%",paddingBottom:"2rem"},children:[(0,r.jsx)("h1",{className:"title-text",style:{paddingBottom:"1rem"},children:"Complete you order"}),(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",maxWidth:"800px",width:"100%",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{maxWidth:"600px",width:"100%",padding:"1rem"},className:"center",children:[(0,r.jsx)("h3",{children:"Order Summery"}),(0,r.jsx)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",border:"1px solid #003735",padding:"5px",background:"#003735",color:"#fff"},children:null===b||void 0===b?void 0:b.map((t=>(0,r.jsx)("p",{style:{width:"Product"===t?"55%":"15%",textAlign:"Product"===t?"start":"center",borderLeft:"Product"===t?"0":"1px solid",fontWeight:"bold"},children:t},t)))}),(0,r.jsxs)("div",{style:{width:"100%",borderLeft:"1px solid",borderRight:"1px solid",borderBottom:"1px solid"},children:[(null===y||void 0===y?void 0:y.length)>0&&(null===y||void 0===y?void 0:y.map(((t,e)=>(0,r.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid",padding:"5px",fontWeight:"bold",height:"4rem"},children:[(0,r.jsx)("p",{style:{width:"55%"},children:"eng"===m?t.productId.eng.name:t.productId.thi.name}),(0,r.jsx)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:null===t||void 0===t?void 0:t.quantity}),(0,r.jsxs)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",null===t||void 0===t?void 0:t.productId.price]}),(0,r.jsxs)("p",{style:{width:"15%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",null===t||void 0===t?void 0:t.deliveryCharge]})]},e)))),(0,r.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",padding:"5px",fontWeight:"bold"},children:[(0,r.jsx)("p",{style:{width:"52.5%"},children:"Total"}),(0,r.jsx)("p",{style:{width:"10%",textAlign:"center",borderLeft:"1px solid",paddingLeft:"20px"},children:null===f||void 0===f||null===(o=f.cart)||void 0===o?void 0:o.totalItems}),(0,r.jsx)("p",{}),(0,r.jsxs)("p",{style:{width:"30%",textAlign:"center",borderLeft:"1px solid"},children:["\u0e3f ",(null===f||void 0===f||null===(n=f.cart)||void 0===n?void 0:n.totalPrice)+x]})]})]})]})}),(0,r.jsx)(i,{totalPrice:(null===f||void 0===f||null===(s=f.cart)||void 0===s?void 0:s.totalPrice)+x,cartId:null===f||void 0===f||null===(u=f.cart)||void 0===u?void 0:u._id}),(0,r.jsx)("div",{style:{height:"20px"}}),(0,r.jsx)(a,{totalPrice:(null===f||void 0===f||null===(h=f.cart)||void 0===h?void 0:h.totalPrice)+x,cartId:null===f||void 0===f||null===(p=f.cart)||void 0===p?void 0:p._id})]})})}}}]);
//# sourceMappingURL=290.4ce516a4.chunk.js.map